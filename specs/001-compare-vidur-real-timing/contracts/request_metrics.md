# `request_metrics.csv` Contract

Produced by:

- `/data1/huangzhe/code/gpu-simulate-test/tmp/real_runs/<run_id>/request_metrics.csv`
- `/data1/huangzhe/code/gpu-simulate-test/tmp/vidur_runs/<run_id>/request_metrics.csv`

All timestamps are integer nanoseconds relative to run start.

## Required columns

- `request_id` (int): 0-based, joins workload and token metrics
- `arrival_time_ns` (int): request arrival time (from workload schedule)
- `first_token_time_ns` (int): timestamp of first produced token
- `ttft_ns` (int): `first_token_time_ns - arrival_time_ns`
- `num_prefill_tokens` (int)
- `num_decode_tokens` (int): requested decode tokens (from workload)
- `num_decode_tokens_actual` (int): produced tokens (real) or proxy produced tokens (vidur; typically equals requested)
- `status` (string): `ok` or `error`

## Optional columns

- `completion_time_ns` (int): last token completion time
- `backend` (string): `sarathi` or `transformers` (real runs)
- `error_type` (string)
- `error_msg` (string)

## Required invariants

- `ttft_ns >= 0`
- For `status == "ok"`:
  - `num_decode_tokens_actual >= 0`
  - If `completion_time_ns` is present: `completion_time_ns >= first_token_time_ns`

## Notes on Vidur-derived values

Vidurâ€™s native metrics are seconds-based and do not export per-token/per-request timestamps. The standardized `request_metrics.csv` produced by `vidur-sim` SHOULD be generated by postprocessing Vidur outputs and converting to the nanosecond representation required here.
